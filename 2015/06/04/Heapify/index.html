
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>[LintCode] - Heapify | LinのCoding</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Lin Du">
    

    
    <meta name="description" content="QuestionlinkGiven an integer array, heapify it into a min-heap array.
For a heap array A, A[0] is the root of heap, and for each A[i], A[i  2 + 1] is the left child of A[i] and A[i  2 + 2] is the righ">
<meta property="og:type" content="article">
<meta property="og:title" content="[LintCode] - Heapify">
<meta property="og:url" content="http://www.piedbiper.tk/2015/06/04/Heapify/index.html">
<meta property="og:site_name" content="LinのCoding">
<meta property="og:description" content="QuestionlinkGiven an integer array, heapify it into a min-heap array.
For a heap array A, A[0] is the root of heap, and for each A[i], A[i  2 + 1] is the left child of A[i] and A[i  2 + 2] is the righ">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="[LintCode] - Heapify">
<meta name="twitter:description" content="QuestionlinkGiven an integer array, heapify it into a min-heap array.
For a heap array A, A[0] is the root of heap, and for each A[i], A[i  2 + 1] is the left child of A[i] and A[i  2 + 2] is the righ">

    
    <link rel="alternative" href="/atom.xml" title="LinのCoding" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="LinのCoding" title="LinのCoding"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="LinのCoding">LinのCoding</a></h1>
				<h2 class="blog-motto">Computer Science != Coding</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
						<li><a href="/tags">Tags</a></li>
					
						<li><a href="/categories">Categories</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.piedbiper.tk">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/06/04/Heapify/" title="[LintCode] - Heapify" itemprop="url">[LintCode] - Heapify</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Lin Du" target="_blank" itemprop="author">Lin Du</a>
		
  <p class="article-time">
    <time datetime="2015-06-05T01:12:54.000Z" itemprop="datePublished"> 發表於 2015-06-04</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目錄</strong>
		
			<ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question"><span class="toc-number">1.</span> <span class="toc-text">Question</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#link"><span class="toc-number">1.1.</span> <span class="toc-text">link</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Example"><span class="toc-number">1.2.</span> <span class="toc-text">Example</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Challenge"><span class="toc-number">1.3.</span> <span class="toc-text">Challenge</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Clarification"><span class="toc-number">1.4.</span> <span class="toc-text">Clarification</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#What_is_heap?"><span class="toc-number">1.4.1.</span> <span class="toc-text">What is heap?</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#What_is_heapify?"><span class="toc-number">1.4.2.</span> <span class="toc-text">What is heapify?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought_and_Solution"><span class="toc-number">2.</span> <span class="toc-text">Thought and Solution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#My_Code_(the_siftdown_approach)"><span class="toc-number">3.</span> <span class="toc-text">My Code (the siftdown approach)</span></a></li></ol>
		
		</div>
		
		<h4 id="Question"><em>Question</em></h4><h5 id="link"><a href="http://www.lintcode.com/en/problem/heapify/#" target="_blank" rel="external">link</a></h5><p>Given an integer array, heapify it into a min-heap array.</p>
<p>For a heap array A, A[0] is the root of heap, and for each A[i], A[i <em> 2 + 1] is the left child of A[i] and A[i </em> 2 + 2] is the right child of A[i].</p>
<h5 id="Example">Example</h5><p>Given [3,2,1,4,5], return [1,2,3,4,5] or any legal heap array.</p>
<h5 id="Challenge">Challenge</h5><p>O(n) time complexity</p>
<h5 id="Clarification">Clarification</h5><h6 id="What_is_heap?"><em>What is heap?</em></h6><p>Heap is a data structure, which usually have three methods: push, pop and top. where “push” add a new element the heap, “pop” delete the minimum/maximum element in the heap, “top” return the minimum/maximum element.</p>
<h6 id="What_is_heapify?"><em>What is heapify?</em></h6><p>Convert an unordered integer array into a heap array. If it is min-heap, for each element A[i], we will get A[i <em> 2 + 1] &gt;= A[i] and A[i </em> 2 + 2] &gt;= A[i].</p>
<p>What if there is a lot of solutions?<br>Return any of them.</p>
<h4 id="Thought_and_Solution"><em>Thought and Solution</em></h4><p>What is the representation of heap?</p>
<p>The heap is often placed in an array with the layout of a complete binary tree. The complete binary tree maps the binary tree structure into the array indices; each array index represents a node:</p>
<pre><code>If <span class="built_in">i</span> is the index of the current node:
Parent of <span class="built_in">i</span> = <span class="built_in">floor</span>((<span class="built_in">i</span> - <span class="number">1</span>) / <span class="number">2</span>)
Left Child of <span class="built_in">i</span> = <span class="number">2</span> * <span class="built_in">i</span> + <span class="number">1</span>
Right Child of <span class="built_in">i</span> = <span class="number">2</span> * <span class="built_in">i</span> + <span class="number">2</span>
</code></pre><p>Then, a sorted array is created by repeatly removing the largest element from the heap(the root of the heap), and inserting it into the array. The heap is updated after each removal to maintain the heap. Once all objects have been removed from the heap, the result is a sorted array.</p>
<p>Heapsort can be performed in place. The array can be split into two parts, the sorted array and the heap. </p>
<p>First, let us have the pseudocode of heapify:</p>
<pre><code>(Put elements <span class="operator">of</span> <span class="string">'a'</span> <span class="operator">in</span> heap order, <span class="operator">in</span>-place)
Procedure heapify(<span class="operator">a</span>, count) is
    (<span class="built_in">start</span> is assigned <span class="operator">the</span> index <span class="operator">in</span> <span class="string">'a'</span> <span class="operator">of</span> <span class="operator">the</span> <span class="keyword">last</span> parent node)
    (<span class="operator">the</span> <span class="keyword">last</span> <span class="keyword">element</span> <span class="operator">in</span> <span class="operator">a</span> <span class="number">0</span>-based array is <span class="keyword">at</span> index count - <span class="number">1</span>; find <span class="operator">the</span> parent <span class="operator">of</span> that <span class="keyword">element</span>)
    <span class="built_in">start</span> = floor((count - <span class="number">2</span>) / <span class="number">2</span>)

    <span class="keyword">while</span> <span class="built_in">start</span> &gt;= <span class="number">0</span> <span class="built_in">do</span>
        (sift down <span class="operator">the</span> node <span class="keyword">at</span> <span class="operator">the</span> index <span class="string">'start'</span> <span class="built_in">to</span> <span class="operator">the</span> proper place such that all nodes below <span class="operator">the</span> <span class="built_in">start</span> index are <span class="operator">in</span> heap order)
        siftDown(<span class="operator">a</span>, <span class="built_in">start</span>, count - <span class="number">1</span>)
        (go <span class="built_in">to</span> <span class="operator">the</span> next parent node)
        <span class="built_in">start</span> = <span class="built_in">start</span> - <span class="number">1</span>
    (<span class="keyword">after</span> sifting down <span class="operator">the</span> root all nodes/elements are <span class="operator">in</span> heap order)


Procedure siftDown(<span class="operator">a</span>, <span class="built_in">start</span>, <span class="function"><span class="keyword">end</span>) <span class="title">is</span> </span>
    root = <span class="built_in">start</span>
    <span class="keyword">while</span> root * <span class="number">2</span> + <span class="number">1</span> &lt;= <span class="function"><span class="keyword">end</span> <span class="title">do</span>  (<span class="title">While</span> <span class="title">the</span> <span class="title">root</span> <span class="title">has</span> <span class="title">at</span> <span class="title">least</span> <span class="title">one</span> <span class="title">chile</span>)</span>
        child = root * <span class="number">2</span> + <span class="number">1</span>
        swap = root

        <span class="keyword">if</span> (<span class="operator">a</span>[swap] &lt; <span class="operator">a</span>[child])
            swap = child
        (If there is <span class="operator">a</span> <span class="constant">right</span> child <span class="operator">and</span> that child is greater)
        <span class="keyword">if</span> (child + <span class="number">1</span> &lt;= <span class="function"><span class="keyword">end</span> <span class="title">and</span> <span class="title">a</span>[<span class="title">swap</span>] &lt; <span class="title">a</span>[<span class="title">child</span> + <span class="title">1</span>])</span>
            swap = child + <span class="number">1</span>
        <span class="keyword">if</span> swap = root
        (The root holds <span class="operator">the</span> largest <span class="keyword">element</span>. Since we assume <span class="operator">the</span> heaps rooted <span class="keyword">at</span> <span class="operator">the</span> children are valid. this means that we are done.)
            <span class="constant">return</span> 
        <span class="keyword">else</span> 
            swap(s[root], <span class="operator">a</span>[swap])
            root = swap (repear <span class="built_in">to</span> continue sifting down <span class="operator">the</span> child now)
</code></pre><p>The <em>heapify</em> procedure can be thought of as building a heap from the bottom up by successively sifting downward to establish the heap property. An alternative version that builds the heap top-down and sifts upward is called “<em>siftup</em>“. This “siftup” version can be visualized as starting with an empty heap and successively inserting elements, but the “siftdown” treats the entire input array as a full but “broken” heap and “repairs” it starting from the last non-trivial sub-heap (that is, the last parent node).</p>
<p>Below is the pesudocode of “siftup”</p>
<pre><code>Procudure heapify(a, count) is
    (<span class="operator"><span class="keyword">end</span> <span class="keyword">is</span> assigned the <span class="keyword">index</span> <span class="keyword">of</span> the <span class="keyword">first</span> child <span class="keyword">of</span> the root)
    <span class="keyword">end</span> = <span class="number">1</span>

    while <span class="keyword">end</span> &lt; <span class="keyword">count</span>
        (sift up the node <span class="keyword">at</span> <span class="keyword">index</span> <span class="keyword">end</span> <span class="keyword">to</span> the proper place such that <span class="keyword">all</span> nodes above the <span class="keyword">end</span> <span class="keyword">index</span> <span class="keyword">are</span> <span class="keyword">in</span> heap <span class="keyword">order</span>)
        siftup(a, <span class="number">0</span>, <span class="keyword">end</span>)
        <span class="keyword">end</span> = <span class="keyword">end</span> + <span class="number">1</span>
    (<span class="keyword">after</span> sifting up the <span class="keyword">last</span> node <span class="keyword">all</span> nodes <span class="keyword">are</span> <span class="keyword">in</span> heap <span class="keyword">order</span>)

<span class="keyword">Procedure</span> siftup(a, <span class="keyword">start</span>, <span class="keyword">end</span>)
    <span class="keyword">input</span>: <span class="keyword">start</span> represents the <span class="keyword">limit</span> <span class="keyword">of</span> how far up the heap <span class="keyword">to</span> sift.
           <span class="keyword">end</span> <span class="keyword">is</span> the node <span class="keyword">to</span> sift up.

    child = <span class="keyword">end</span>
    while child &gt; <span class="keyword">start</span>
        parent = <span class="keyword">floor</span> ((child - <span class="number">1</span>) / <span class="number">2</span>)
        <span class="keyword">if</span> a[parent] &lt; a[child] 
            swap(a[parent], a[child])
            child = parent (<span class="keyword">repeat</span> <span class="keyword">to</span> <span class="keyword">continue</span> sifting up the parent <span class="keyword">now</span>)
        <span class="keyword">else</span>
            <span class="keyword">return</span></span>
</code></pre><p>For comparison, the “siftdown” has O(n) time complexity, while the “siftup” has O(nlogn) time complexity due to its equivalence with inserting each element, one at a time, into an empty heap.</p>
<h4 id="My_Code_(the_siftdown_approach)"><em>My Code (the siftdown approach)</em></h4><pre><code>public class Solution {
    /**
<span class="label">     * @param A:</span> Given an integer array
<span class="label">     * @return:</span> void
     */
    public void heapify(int[] <span class="literal">A</span>) {
        // write your code here
        for (int i = <span class="literal">A</span>.length/<span class="number">2</span><span class="comment">; i &gt;= 0; i--) {</span>
            siftdown(<span class="literal">A</span>, i)<span class="comment">;</span>
        }

    }

    public void siftdown(int[] <span class="literal">A</span>, int k) {
         <span class="keyword">while</span> (k &lt; <span class="literal">A</span>.length) {
            int smallest = k<span class="comment">;</span>
            <span class="keyword">if</span> (k * <span class="number">2</span> + <span class="number">1</span> &lt; <span class="literal">A</span>.length &amp;&amp; <span class="literal">A</span>[k * <span class="number">2</span> + <span class="number">1</span>] &lt; <span class="literal">A</span>[smallest]) {
                smallest = k * <span class="number">2</span> + <span class="number">1</span><span class="comment">;</span>
            }
            <span class="keyword">if</span> (k * <span class="number">2</span> + <span class="number">2</span> &lt; <span class="literal">A</span>.length &amp;&amp; <span class="literal">A</span>[k * <span class="number">2</span> + <span class="number">2</span>] &lt; <span class="literal">A</span>[smallest]) {
                smallest = k * <span class="number">2</span> + <span class="number">2</span><span class="comment">;</span>
            }
            <span class="keyword">if</span> (smallest == k) {
                <span class="keyword">break</span><span class="comment">;</span>
            }
            int temp = <span class="literal">A</span>[smallest]<span class="comment">;</span>
            <span class="literal">A</span>[smallest] = <span class="literal">A</span>[k]<span class="comment">;</span>
            <span class="literal">A</span>[k] = temp<span class="comment">;</span>
            swap(<span class="literal">A</span>[smallest], <span class="literal">A</span>[k])<span class="comment">;</span>
            k = smallest<span class="comment">;</span>
        }
    }
}
</code></pre>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/LintCode/">LintCode</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Algorithms/">Algorithms</a><a href="/tags/Heap/">Heap</a><a href="/tags/LintCode/">LintCode</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://www.piedbiper.tk/2015/06/04/Heapify/" data-title="[LintCode] - Heapify | LinのCoding" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/06/04/LongestConsecutiveSequence/" title="[LintCode] - LongestConsecutiveSequence">
  <strong>上一篇：</strong><br/>
  <span>
  [LintCode] - LongestConsecutiveSequence</span>
</a>
</div>


<div class="next">
<a href="/2015/06/01/ImplementQueueByTwoStacks/"  title="[LintCode] - Implement Queue by Two Stacks">
 <strong>下一篇：</strong><br/> 
 <span>[LintCode] - Implement Queue by Two Stacks
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目錄</strong>
 
 <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Question"><span class="toc-number">1.</span> <span class="toc-text">Question</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#link"><span class="toc-number">1.1.</span> <span class="toc-text">link</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Example"><span class="toc-number">1.2.</span> <span class="toc-text">Example</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Challenge"><span class="toc-number">1.3.</span> <span class="toc-text">Challenge</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Clarification"><span class="toc-number">1.4.</span> <span class="toc-text">Clarification</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#What_is_heap?"><span class="toc-number">1.4.1.</span> <span class="toc-text">What is heap?</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#What_is_heapify?"><span class="toc-number">1.4.2.</span> <span class="toc-text">What is heapify?</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Thought_and_Solution"><span class="toc-number">2.</span> <span class="toc-text">Thought and Solution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#My_Code_(the_siftdown_approach)"><span class="toc-number">3.</span> <span class="toc-text">My Code (the siftdown approach)</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分類</p>
		<ul>
		
		  
			<li><a href="/categories/Algorithm/" title="Algorithm">Algorithm<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/AnalysisofAlgorithms/" title="AnalysisofAlgorithms">AnalysisofAlgorithms<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/LeetCode/" title="LeetCode">LeetCode<sup>45</sup></a></li>
		  
		
		  
			<li><a href="/categories/LintCode/" title="LintCode">LintCode<sup>9</sup></a></li>
		  
		
		  
			<li><a href="/categories/Others/" title="Others">Others<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">標簽</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Algorithms/" title="Algorithms">Algorithms<sup>56</sup></a></li>
			
		
			
				<li><a href="/tags/LeetCode/" title="LeetCode">LeetCode<sup>45</sup></a></li>
			
		
			
				<li><a href="/tags/Math/" title="Math">Math<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/Array/" title="Array">Array<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/HashTable/" title="HashTable">HashTable<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/LintCode/" title="LintCode">LintCode<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/LinkedList/" title="LinkedList">LinkedList<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/TwoPointers/" title="TwoPointers">TwoPointers<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/String/" title="String">String<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/Tree/" title="Tree">Tree<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/DFS/" title="DFS">DFS<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Backtracking/" title="Backtracking">Backtracking<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Stack/" title="Stack">Stack<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Others/" title="Others">Others<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DynamicProgramming/" title="DynamicProgramming">DynamicProgramming<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Sorting/" title="Sorting">Sorting<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Linked-List/" title="Linked List">Linked List<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Queue/" title="Queue">Queue<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Heap/" title="Heap">Heap<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DP/" title="DP">DP<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情鏈接</p>
    <ul>
        
          <li>
            
            	<a href="https://leetcode.com/" target="_blank" title="LeetCode">LeetCode</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 訂閱</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Lin Du from WPI. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/LinsanityDu for https://github.com/LinsanityDu" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2015 
		
		<a href="/about" target="_blank" title="Lin Du">Lin Du</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回頂部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
